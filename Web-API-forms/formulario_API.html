<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Formulario API</title>
        <style>
            table{
                text-align: center;
                background-color: #F96;
                width:25%;
                margin:auto;
                border:2px #F30 dashed;
            }
            td{
                padding:15px;
            }
        </style>
        <script>
            var edad;
            function comenzar(){
                edad=document.getElementById("edad");
                edad.addEventListener("change", cambiar_rango, false);
                document.datos_usuario.addEventListener("invalid", validar, true);
                document.getElementById("enviar").addEventListener("click", enviar, false);
                document.datos_usuario.addEventListener("input", validar_tiempo_real, false);
                /*var nombre=document.getElementById("nombre");
                var apellido=document.getElementById("apellido");
                nombre.addEventListener("input", validar, false);
                apellido.addEventListener("input", validar, false);
                validar();*/
            }
            function cambiar_rango(){
                var salida=document.getElementById("rango");
                var calculo=edad.value-30;
                if(calculo<30){
                    calculo=0;
                    edad.value=30;
                }
                salida.innerHTML=calculo+" a "+edad.value;
            }
            function validar(e){
                var elemento=e.target;
                elemento.style.background="#FFDDDD"
            }
            function enviar(){
                var cuadro_usuario=document.getElementById("usuario");
                var correcto=document.datos_usuario.checkValidity();
                if(correct==true){
                    document.datos_usuario.submit();
                }
                else if(cuadro_usuario.validity.valueMissing==true || cuadro_usuario.validity.patternMismatch==true){
                    alert("El usuario no puede estar vacío y recuerda que tiene que tener 3 letras");
                }
            }
            function validar_tiempo_real(e){
                var elemento=e.target;
                if(elemento.validity.valid==true){
                    elemento.style.background="#FFFFFF";
                }
                else{
                    elemento.style.background="#FFDDDD";
                }
            }
            window.addEventListener("load", comenzar, false)
        </script>
    </head>
    <body>
        <section>
            <form name="datos_usuario" method="GET">
                <!--<datalist id="informacion">
                    <option value="9991427498" label="Teléfono 1">
                    <option value="9992008669" label="Teléfono 2">
                    <option value="9991715801" label="Teléfono 3">
                </datalist>
                Teléfono: &nbsp;<input type="tel" name="telefono" id="telefono" list="informacion">-->
                <table>
                    <!--<tr>
                        <td>
                            Nombre:
                        </td>
                        <td>
                            <input type="text" name="nombre" id="nombre">
                        </td>
                    </tr>-->
                    <!--<tr>
                        <td>
                            Apellido:
                        </td>
                        <td>
                            <input type="text" name="apellido" id="apellido">
                        </td>
                    </tr>-->
                    <tr>
                        <td>
                            Usuario:
                        </td>
                        <td>
                            <input pattern="[A-Za-z]{3}" name="usuario" id="usuario" maxlength="10" required>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Email:
                        </td>
                        <td>
                            <input type="email" name="email" id="email" required>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Edad:
                        </td>
                        <td>
                            <input type="range" name="edad" id="edad" min="0" max="120" value="30" step="30">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <output id="rango">0 a 30</output>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="submit" id="enviar" value="Registrar">
                        </td>
                    </tr>
                </table>
            </form>
        </section>
    </body>
</html>